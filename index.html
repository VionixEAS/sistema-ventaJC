<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JC CHAPAS & HIERROS - Sistema de Gesti√≥n</title>
  <link rel="icon" href="assets/logo_jc.svg"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.4/jspdf.plugin.autotable.min.js" defer></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --red1:#0a0a0a; --red2:#7f1d1d; --red3:#b91c1c; }
    body {
      background: linear-gradient(135deg, var(--red1), var(--red2), var(--red3));
      color: #f3f3f3;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      min-height: 100vh;
    }
    .glass { background: rgba(0,0,0,.35); border: 1px solid rgba(185, 28, 28, .3); backdrop-filter: blur(8px); border-radius: 1rem; box-shadow: 0 0 20px rgba(185, 28, 28, .2); }
    .btn-red { background:#b91c1c; transition: all .2s; border-radius: .6rem; }
    .btn-red:hover { background:#dc2626; }
    .btn-soft { background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.14); border-radius: .75rem; transition: all .2s; }
    .btn-soft:hover { background: rgba(255,255,255,.12); }
    .input-dark { background: rgba(255,255,255,.1); border: 1px solid rgba(255,255,255,.2); color:#fff; border-radius:.6rem; padding:.55rem .75rem; }
    .sidebar { background: rgba(185,28,28,.22); border: 1px solid rgba(185,28,28,.35); backdrop-filter: blur(8px); border-radius: 1rem; box-shadow: inset 0 0 8px rgba(0,0,0,.25); }
    .sidebar a { display:flex; align-items:center; gap:.6rem; padding:.7rem .9rem; border-radius:.7rem; color:#fff; }
    .sidebar a.active, .sidebar a:hover { background: rgba(255,255,255,.12); }
  </style>
</head>
<body class="flex flex-col">
  <header class="w-full px-4 py-3 bg-gradient-to-r from-red-900 via-red-700 to-red-600 shadow-lg">
    <div class="max-w-7xl mx-auto flex items-center gap-4">
      <img src="assets/logo_jc.svg" alt="Logo JC" class="w-14 h-14 rounded-md"/>
      <div class="leading-tight">
        <h1 class="text-2xl font-extrabold tracking-wide">JC CHAPAS &amp; HIERROS</h1>
        <p class="text-sm">RUC 6519029-0 ‚Ä¢ KM 8 Acaray, Barrio San Juan ‚Ä¢ Tel. 0971 888 289</p>
      </div>
    </div>
  </header>

  <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 grid grid-cols-1 lg:grid-cols-[260px_1fr] gap-6 flex-1">
    <aside class="sidebar p-3 self-start sticky top-4 h-max">
      <div class="flex items-center gap-2 mb-3 px-2">
        <img src="assets/logo_jc.svg" class="w-10 h-10" alt="logo"/>
        <div class="font-semibold">Bienvenido al sistema</div>
      </div>
      <div class="px-2 pb-2 text-xs uppercase tracking-wide text-white/80">Men√∫</div>
      <nav class="flex flex-col gap-1">
        <a href="#" data-view="catalogo" class="active" onclick="showView('catalogo', this)">üõí Cat√°logo</a>
        <a href="#" data-view="cotizador" onclick="showView('cotizador', this)">üßæ Cotizador</a>
        <a href="#" data-view="ventas" onclick="showView('ventas', this)">üìö Registro de Ventas</a>
        <a href="#" data-view="inventario" onclick="showView('inventario', this)">üì¶ Inventario</a>
        <a href="#" data-view="config" onclick="showView('config', this)">‚öôÔ∏è Configuraci√≥n</a>
      </nav>
    </aside>

    <main class="space-y-6">
      <section class="glass p-4">
        <h2 class="text-xl font-bold">Bienvenido al sistema de gesti√≥n JC CHAPAS &amp; HIERROS</h2>
        <p class="text-white/80 text-sm">Control total de cat√°logo, cotizaci√≥n y ventas</p>
      </section>

      <section id="view-catalogo" class="glass p-6">
        <div class="flex flex-col md:flex-row gap-3 md:items-end mb-4">
          <div class="flex-1">
            <label class="text-sm text-white/80">N√∫mero de WhatsApp (con pa√≠s, sin +):</label>
            <input id="waNumber" class="input-dark w-full mt-1" placeholder="595971888289"/>
          </div>
          <div class="flex-1">
            <label class="text-sm text-white/80">Buscar producto</label>
            <input id="buscarCatalogo" class="input-dark w-full mt-1" placeholder="Buscar por nombre o tipo..."/>
          </div>
          <button id="btnEnviarWA" class="btn-red px-4 py-2">üì≤ Enviar pedido por WhatsApp</button>
        </div>
        <div id="gridCatalogo" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        <div class="mt-3 text-sm text-white/80" id="resumenCatalogo">0 √≠tems seleccionados ‚Ä¢ Total: Gs 0</div>
      </section>

      <section id="view-cotizador" class="glass p-6 hidden">
        <h2 class="text-xl font-bold mb-2 text-center">Cotizador de Productos</h2>
        <div class="mb-3">
          <button id="btnAgregarProducto" class="btn-red px-4 py-2">‚ûï Agregar Producto</button>
        </div>
        <div id="listaProductos" class="space-y-2"></div>
        <div class="mt-6 flex flex-wrap gap-3 justify-between items-center">
          <button id="btnGenerarPDF" class="btn-red px-4 py-2">üìÑ Generar presupuesto (PDF)</button>
          <button id="btnRegistrarVenta" class="btn-red px-4 py-2">üíæ Registrar Venta</button>
          <button id="btnWAfromCotizador" class="btn-red px-4 py-2">üì≤ WhatsApp</button>
        </div>
      </section>

      <section id="view-ventas" class="glass p-6 hidden">
        <h2 class="text-xl font-bold mb-4 text-center">Registro de Ventas</h2>
        <div id="tablaVentas" class="overflow-x-auto text-sm">
          <p class="text-center text-white/70">A√∫n no hay ventas registradas.</p>
        </div>
      </section>

      <section id="view-inventario" class="glass p-6 hidden">
        <h2 class="text-xl font-bold mb-2">Inventario</h2>
        <p class="text-white/80 text-sm">Pr√≥xima etapa: control de stock, umbrales y alertas.</p>
      </section>

      <section id="view-config" class="glass p-6 hidden">
        <h2 class="text-xl font-bold mb-4">Configuraci√≥n</h2>
        <p class="text-sm text-white/80 mb-2">Las credenciales se leen de <code>assets/config/config.json</code>.</p>
        <p class="text-sm text-white/80">Asegurate de tener las tablas <code>public.productos</code> y <code>public.ventas</code>.</p>
      </section>
    </main>
  </div>

  <div id="modalProducto" class="fixed inset-0 hidden items-center justify-center bg-black/60">
    <div class="glass p-6 w-full max-w-md">
      <h2 class="text-lg font-bold mb-4">Agregar nuevo producto</h2>
      <input id="nombreProd" class="input-dark w-full mb-3" placeholder="Nombre del producto"/>
      <select id="tipoProd" class="input-dark w-full mb-3">
        <option value="kg">Por Kg</option>
        <option value="metro">Por Metro</option>
        <option value="unidad">Por Unidad</option>
      </select>
      <input id="precioProd" type="number" class="input-dark w-full mb-3" placeholder="Precio"/>
      <textarea id="descProd" class="input-dark w-full mb-3" placeholder="Descripci√≥n (opcional)"></textarea>
      <input id="imagenProd" class="input-dark w-full mb-3" placeholder="URL de la imagen (https://...)"/>
      <div class="flex justify-end gap-2">
        <button id="btnCancelarProd" class="btn-soft px-3 py-1">Cancelar</button>
        <button id="btnGuardarProd" class="btn-red px-3 py-1">Guardar</button>
      </div>
    </div>
  </div>

  <div id="modalVenta" class="fixed inset-0 hidden items-center justify-center bg-black/60">
    <div class="glass p-6 w-full max-w-md">
      <h2 class="text-lg font-bold mb-4">Registrar venta</h2>
      <input id="clienteVenta" class="input-dark w-full mb-3" placeholder="Nombre del cliente"/>
      <select id="metodoVenta" class="input-dark w-full mb-3">
        <option value="Efectivo">Efectivo</option>
        <option value="Transferencia">Transferencia</option>
        <option value="Tarjeta">Tarjeta</option>
      </select>
      <div class="flex justify-end gap-2">
        <button id="btnCancelarVenta" class="btn-soft px-3 py-1">Cancelar</button>
        <button id="btnGuardarVenta" class="btn-red px-3 py-1">Guardar</button>
      </div>
    </div>
  </div>

  <script>
    function showView(view, el) {
      const ids = ["catalogo","cotizador","ventas","inventario","config"];
      ids.forEach(v => {
        const sec = document.getElementById("view-"+v);
        if (sec) sec.classList.toggle("hidden", v !== view);
      });
      document.querySelectorAll(".sidebar a").forEach(a=>a.classList.remove("active"));
      if (el) el.classList.add("active");
    }
  </script>
  <script src="js/supabase.js" defer></script>
  <script src="js/app.js" defer></script>
</body>
</html>
